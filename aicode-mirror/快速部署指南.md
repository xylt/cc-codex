# AI Code Mirror 快速部署指南

## 5 分钟快速部署

### 前提条件
- 阿里云 ECS 服务器（Ubuntu 22.04）
- 项目文件已上传到服务器

---

## 一键部署流程

### 1️⃣ 连接服务器

```bash
ssh root@your-server-ip
```

### 2️⃣ 初始化服务器

```bash
cd /var/www/aicode-mirror
chmod +x setup-server.sh
./setup-server.sh
```

等待 5-10 分钟，自动安装所有依赖。

### 3️⃣ 配置环境变量

```bash
cd backend
vim .env.production
```

**必须修改:**
- `JWT_SECRET`: 改为随机字符串
- `CORS_ORIGIN`: 改为你的域名
- `MONGODB_URI`: 如果使用远程数据库，修改连接字符串

保存并退出（`:wq`）

### 4️⃣ 配置 Nginx

```bash
# 编辑配置文件
vim /var/www/aicode-mirror/nginx.conf

# 将 your-domain.com 替换为你的域名
# 保存后复制到 Nginx 目录
cp nginx.conf /etc/nginx/sites-available/aicode-mirror
ln -s /etc/nginx/sites-available/aicode-mirror /etc/nginx/sites-enabled/
rm /etc/nginx/sites-enabled/default

# 测试并重启
nginx -t
systemctl restart nginx
```

### 5️⃣ 部署应用

```bash
chmod +x deploy.sh
./deploy.sh
```

### 6️⃣ 验证部署

打开浏览器访问: `http://your-server-ip`

---

## 后续更新

每次代码更新后，只需运行:

```bash
cd /var/www/aicode-mirror
./deploy.sh
```

---

## 常用命令

```bash
# 查看服务状态
pm2 status

# 查看日志
pm2 logs

# 重启服务
pm2 restart aicode-mirror-backend

# 查看 Nginx 日志
tail -f /var/log/nginx/aicode-mirror-error.log
```

---

## 配置 HTTPS

```bash
# 安装 Certbot
apt install -y certbot python3-certbot-nginx

# 获取证书
certbot --nginx -d your-domain.com -d www.your-domain.com
```

---

## 遇到问题？

查看完整文档: [部署文档.md](./部署文档.md)

微信支持: `aicode-support`
